/**
* @license
*
* Regression.JS - Regression functions for javascript
* http://tom-alexander.github.com/regression-js/
*
* copyright(c) 2013 Tom Alexander
* Licensed under the MIT license.
*
* @module regression - Least-squares regression functions for JavaScript
**/
!function(a,b){var c;"function"==typeof define&&define.amd?define("regression",["exports"],b):"undefined"!=typeof exports?b(exports):(c={exports:{}},b(c.exports),a.regression=c.exports)}(this,function(a){"use strict";function b(a,b){var c=a.reduce(function(a,b){return a+b[1]}),d=c/a.length,e=a.reduce(function(a,b){var c=b[1]-d;return a+c*c}),f=a.reduce(function(a,c,d){var e=c[1]-b[d];return a+e*e});return 1-f/e}function c(a,b){var c=0,d=0,e=0,f=0,g=0,h=a.length-1,i=new Array(b);for(c=0;h>c;c++){for(f=c,d=c+1;h>d;d++)Math.abs(a[c][d])>Math.abs(a[c][f])&&(f=d);for(e=c;h+1>e;e++)g=a[e][c],a[e][c]=a[e][f],a[e][f]=g;for(d=c+1;h>d;d++)for(e=h;e>=c;e--)a[e][d]-=a[e][c]*a[c][d]/a[c][c]}for(d=h-1;d>=0;d--){for(g=0,e=d+1;h>e;e++)g+=a[e][d]*i[e];i[d]=(a[h][d]-g)/a[d][d]}return i}function d(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}Object.defineProperty(a,"__esModule",{value:!0});var e=2,f={linear:function(a){for(var c,f,g,h=[0,0,0,0,0],i=a.length,j=0;i>j;j++)null!==a[j][1]&&(h[0]+=a[j][0],h[1]+=a[j][1],h[2]+=a[j][0]*a[j][0],h[3]+=a[j][0]*a[j][1],h[4]+=a[j][1]*a[j][1]);return f=(i*h[3]-h[0]*h[1])/(i*h[2]-h[0]*h[0]),g=h[1]/i-f*h[0]/i,c=a.map(function(a){var b=a[0];return[b,f*b+g]}),{r2:b(a,c),equation:[f,g],points:c,string:"y = "+d(f,e)+"x + "+d(g,e)}},linearthroughorigin:function(a){for(var c,f,g=[0,0],h=0;h<a.length;h++)null!==a[h][1]&&(g[0]+=a[h][0]*a[h][0],g[1]+=a[h][0]*a[h][1]);return c=g[1]/g[0],f=a.map(function(a){var b=a[0];return[b,c*b]}),{r2:b(a,f),equation:[c],points:f,string:"y = "+d(c,e)+"x"}},exponential:function(a){for(var c,f,g,h,i=[0,0,0,0,0,0],j=0;j<a.length;j++)null!==a[j][1]&&(i[0]+=a[j][0],i[1]+=a[j][1],i[2]+=a[j][0]*a[j][0]*a[j][1],i[3]+=a[j][1]*Math.log(a[j][1]),i[4]+=a[j][0]*a[j][1]*Math.log(a[j][1]),i[5]+=a[j][0]*a[j][1]);return c=i[1]*i[2]-i[5]*i[5],f=Math.exp((i[2]*i[3]-i[5]*i[4])/c),g=(i[1]*i[4]-i[5]*i[3])/c,h=a.map(function(a){var b=a[0];return[b,f*Math.exp(g*b)]}),{r2:b(a,h),equation:[f,g],points:h,string:"y = "+d(f,e)+"e^("+d(g,e)+"x)"}},logarithmic:function(a){for(var c,f,g,h=[0,0,0,0],i=a.length,j=0;i>j;j++)null!==a[j][1]&&(h[0]+=Math.log(a[j][0]),h[1]+=a[j][1]*Math.log(a[j][0]),h[2]+=a[j][1],h[3]+=Math.pow(Math.log(a[j][0]),2));return f=(i*h[1]-h[2]*h[0])/(i*h[3]-h[0]*h[0]),c=(h[2]-f*h[0])/i,g=a.map(function(a){var b=a[0];return[b,c+f*Math.log(b)]}),{r2:b(a,g),equation:[c,f],points:g,string:"y = "+d(c,e)+" + "+d(f,e)+" ln(x)"}},power:function(a){for(var c,f,g,h=[0,0,0,0],i=a.length,j=0;i>j;j++)null!==a[j][1]&&(h[0]+=Math.log(a[j][0]),h[1]+=Math.log(a[j][1])*Math.log(a[j][0]),h[2]+=Math.log(a[j][1]),h[3]+=Math.pow(Math.log(a[j][0]),2));return f=(i*h[1]-h[2]*h[0])/(i*h[3]-h[0]*h[0]),c=Math.exp((h[2]-f*h[0])/i),g=a.map(function(a){var b=a[0];return[b,c*Math.pow(b,f)]}),{r2:b(a,g),equation:[c,f],points:g,string:"y = "+d(c,e)+"x^"+d(f,e)}},polynomial:function(a,f){var g,h,i,j,k,l,m,n,o=[],p=[],q=0,r=0,s=a.length;for(h="undefined"==typeof f?3:f+1,i=0;h>i;i++){for(k=0;s>k;k++)null!==a[k][1]&&(q+=Math.pow(a[k][0],i)*a[k][1]);for(o.push(q),q=0,g=[],j=0;h>j;j++){for(k=0;s>k;k++)null!==a[k][1]&&(r+=Math.pow(a[k][0],i+j));g.push(r),r=0}p.push(g)}for(p.push(o),m=c(p,h),l=a.map(function(a){var b=a[0],c=m.reduce(function(a,c,d){return a+c*Math.pow(b,d)});return[b,c]}),n="y = ",i=m.length-1;i>=0;i--)n+=i>1?d(m[i],e)+"x^"+i+" + ":1===i?d(m[i],e)+"x + ":d(m[i],e);return{r2:b(a,l),equation:m,points:l,string:n}},lastvalue:function(a){for(var c=[],d=null,e=0;e<a.length;e++)null!==a[e][1]&&isFinite(a[e][1])?(d=a[e][1],c.push([a[e][0],a[e][1]])):c.push([a[e][0],d]);return{r2:b(a,c),equation:[d],points:c,string:""+d}}};a.regression=function(a,b,c){return"string"==typeof a?f[a.toLowerCase()](b,c):null}});